<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=gb2312">
<meta name=ProgId content=Word.Document>
<title>无标题文档</title>



<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:宋体;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:SimSun;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:515 680460288 22 0 262145 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:1;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:0 0 0 0 0 0;}
@font-face
	{font-family:"\@宋体";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:515 680460288 22 0 262145 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-unhide:no;
	mso-style-link:"页眉 Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	tab-stops:center 207.65pt right 415.3pt;
	layout-grid-mode:char;
	border:none;
	mso-border-bottom-alt:solid windowtext .75pt;
	padding:0cm;
	mso-padding-alt:0cm 0cm 1.0pt 0cm;
	font-size:9.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-unhide:no;
	mso-style-link:"页脚 Char";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:center 207.65pt right 415.3pt;
	layout-grid-mode:char;
	font-size:9.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;}
p
	{mso-style-unhide:no;
	mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;}
p.style2, li.style2, div.style2
	{mso-style-name:style2;
	mso-style-unhide:no;
	mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;
	color:blue;
	font-weight:bold;}
span.style21
	{mso-style-name:style21;
	mso-style-unhide:no;
	color:blue;
	font-weight:bold;}
span.Char
	{mso-style-name:"页眉 Char";
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:页眉;
	mso-ansi-font-size:9.0pt;
	mso-bidi-font-size:9.0pt;
	font-family:宋体;
	mso-ascii-font-family:宋体;
	mso-fareast-font-family:宋体;
	mso-hansi-font-family:宋体;
	mso-bidi-font-family:宋体;}
span.Char0
	{mso-style-name:"页脚 Char";
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:页脚;
	mso-ansi-font-size:9.0pt;
	mso-bidi-font-size:9.0pt;
	font-family:宋体;
	mso-ascii-font-family:宋体;
	mso-fareast-font-family:宋体;
	mso-hansi-font-family:宋体;
	mso-bidi-font-family:宋体;}
.MsoChpDefault
	{mso-style-type:export-only;
	mso-default-props:yes;
	font-size:10.0pt;
	mso-ansi-font-size:10.0pt;
	mso-bidi-font-size:10.0pt;
	mso-ascii-font-family:"Times New Roman";
	mso-hansi-font-family:"Times New Roman";
	mso-font-kerning:0pt;}
 /* Page Definitions */
 
@page Section1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:42.55pt;
	mso-footer-margin:49.6pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>

</head>

<body lang=ZH-CN style='tab-interval:21.0pt'>

<div class=Section1>

<p class=style2><span style='font-size:13.5pt'>函数简介<span lang=EN-US>:</span></span></p>

<p><span style='font-size:13.5pt'>获取插件命令的最后错误<span lang=EN-US></span></span></p>

<p><span class=style21><span style='font-size:13.5pt'>函数原型<span lang=EN-US>:</span></span></span><span
lang=EN-US style='font-size:13.5pt'><br>
<br>
long<span style='mso-spacerun:yes'>&nbsp; </span>GetLastError()</span></p>

<p><span class=style21><span style='font-size:13.5pt'>参数定义<span lang=EN-US>:</span></span></span><span
lang=EN-US style='font-size:13.5pt'></span></p>

<p><span class=style21><span style='font-size:13.5pt'>返回值<span lang=EN-US>:</span></span></span><span
lang=EN-US style='font-size:13.5pt'></span></p>

<p><span style='font-size:13.5pt;color:maroon'>整形数<span lang=EN-US>:<br>
</span></span><span style='font-size:13.5pt'>返回值表示错误值。<span lang=EN-US> 0</span>表示无错误<span
lang=EN-US>.<span style='color:maroon'></span></span></span></p>

<p><span lang=EN-US style='font-size:13.5pt'>-1 : </span><span
style='font-size:13.5pt'>表示你使用了绑定里的收费功能，但是没注册，无法使用<span lang=EN-US>.<br>
-2 : </span>使用模式<span lang=EN-US>0 2 </span>时出现，因为目标窗口有保护<span lang=EN-US>. </span>常见于<span
lang=EN-US>win7</span>以上系统<span lang=EN-US>.</span>或者有安全软件拦截插件<span lang=EN-US
style='color:fuchsia'>.</span><span style='color:fuchsia'>解决办法<span lang=EN-US>:
</span>关闭所有安全软件，然后再重新尝试<span lang=EN-US>. </span>如果还不行就可以肯定是目标窗口有特殊保护<span
lang=EN-US>. </span></span><span lang=EN-US><br>
-3 : </span>使用模式<span lang=EN-US>0 2 </span>时出现，可能目标窗口有保护，也可能是异常错误<span
lang=EN-US>. </span>可以尝试换绑定模式或许可以解决<span lang=EN-US>.<br>
-4 : </span>使用模式<span lang=EN-US>101 103</span>时出现，这是异常错误<span lang=EN-US>.<br>
-5 : </span>使用模式<span lang=EN-US>101 103</span>时出现<span lang=EN-US>, </span>这个错误的解决办法就是关闭目标窗口，重新打开再绑定即可<span
lang=EN-US>. </span>也可能是运行脚本的进程没有管理员权限<span lang=EN-US>. <br>
<span style='color:fuchsia'>-6 : </span></span><span style='color:fuchsia'>被安全软件拦截。
典型的是金山<span lang=EN-US>.360</span>等<span lang=EN-US>. </span>如果是<span
lang=EN-US>360</span>关闭即可。 如果是金山，必须卸载，关闭是没用的<span lang=EN-US>.<br>
</span></span><span lang=EN-US>-7 -9 : </span>使用模式<span lang=EN-US>101 103</span>时出现<span
lang=EN-US>,</span>异常错误<span lang=EN-US>. </span>还有可能是安全软件的问题，比如<span
lang=EN-US>360</span>等。尝试卸载<span lang=EN-US>360.<br>
-8 -10 : </span>使用模式<span lang=EN-US>101 103</span>时出现<span lang=EN-US>, </span>目标进程可能有保护<span
lang=EN-US>,</span>也可能是插件版本过老，试试新的或许可以解决<span lang=EN-US>. <span
style='color:fuchsia'>-8</span></span><span style='color:fuchsia'>可以尝试使用<span
lang=EN-US>DmGuard</span>中的<span lang=EN-US>np2</span>盾配合</span><span
lang=EN-US>.<br>
-11 : </span>使用模式<span lang=EN-US>101 103</span>时出现<span lang=EN-US>, </span>目标进程有保护<span
lang=EN-US>. </span>告诉我解决。<span lang=EN-US><br>
-12 : </span>使用模式<span lang=EN-US>101 103</span>时出现<span lang=EN-US>, </span>目标进程有保护<span
lang=EN-US>. </span>告诉我解决。<span lang=EN-US><br>
-13 : </span>使用模式<span lang=EN-US>101 103</span>时出现<span lang=EN-US>, </span>目标进程有保护<span
lang=EN-US>. </span>或者是因为上次的绑定没有解绑导致。 尝试在绑定前调用<span lang=EN-US>ForceUnBindWindow.
<br>
-37 : </span>使用模式<span lang=EN-US>101 103</span>时出现<span lang=EN-US>, </span>目标进程有保护<span
lang=EN-US>. </span>告诉我解决。<span lang=EN-US><br>
-14 : </span>可能系统缺少部分<span lang=EN-US>DLL,</span>尝试安装<span lang=EN-US>d3d. </span>或者是鼠标或者键盘使用了<span
lang=EN-US>dx.mouse.api</span>或者<span lang=EN-US>dx.keypad.api</span>，但实际系统没有插鼠标和键盘<span
lang=EN-US>. </span>也有可能是图色中有<span lang=EN-US>dx.graphic.3d</span>之类的<span
lang=EN-US>,</span>但相应的图色被占用<span lang=EN-US>,</span>比如全屏<span lang=EN-US>D3D</span>程序<span
lang=EN-US>.<br>
-16 : </span>可能使用了绑定模式<span lang=EN-US> 0 </span>和<span lang=EN-US> 101</span>，然后可能指定了一个子窗口<span
lang=EN-US>.</span>导致不支持<span lang=EN-US>.</span>可以换模式<span lang=EN-US>2</span>或者<span
lang=EN-US>103</span>来尝试<span lang=EN-US>. </span>另外也可以考虑使用父窗口或者顶级窗口<span
lang=EN-US>.</span>来避免这个错误。还有可能是目标窗口没有正常解绑 然后再次绑定的时候<span lang=EN-US>.<br>
-17 : </span>模式<span lang=EN-US>101 103</span>时出现<span lang=EN-US>. </span>这个是异常错误<span
lang=EN-US>. </span>告诉我解决<span lang=EN-US>.<br>
-18 : </span>句柄无效<span lang=EN-US>.<br>
-19 : </span>使用模式<span lang=EN-US>0 11 101</span>时出现<span lang=EN-US>,</span>这是异常错误<span
lang=EN-US>,</span>告诉我解决<span lang=EN-US>.<br>
-20 : </span>使用模式<span lang=EN-US>101 103 </span>时出现<span lang=EN-US>,</span>说明目标进程里没有解绑，并且子绑定达到了最大<span
lang=EN-US>. </span>尝试在返回这个错误时，调用<span lang=EN-US>ForceUnBindWindow</span>来强制解除绑定<span
lang=EN-US>.<br>
-21 : </span>使用模式任何模式时出现<span lang=EN-US>,</span>说明目标进程已经存在了绑定<span lang=EN-US>(</span><span
style='color:fuchsia'>没有正确解绑就退出了<span lang=EN-US>?</span>被其它软件绑定<span
lang=EN-US>?,</span>或者多个线程同时进行了绑定<span lang=EN-US>?</span></span><span
lang=EN-US>). </span>尝试在返回这个错误时，调用<span lang=EN-US>ForceUnBindWindow</span>来强制解除绑定<span
lang=EN-US>.</span>或者检查自己的代码<span lang=EN-US>.<br>
-22 : </span>使用模式<span lang=EN-US>0 2,</span>绑定<span lang=EN-US>64</span>位进程窗口时出现<span
lang=EN-US>,</span>因为安全软件拦截插件释放的<span lang=EN-US>EXE</span>文件导致<span
lang=EN-US>.<br>
-23 : </span>使用模式<span lang=EN-US>0 2,</span>绑定<span lang=EN-US>64</span>位进程窗口时出现<span
lang=EN-US>,</span>因为安全软件拦截插件释放的<span lang=EN-US>DLL</span>文件导致<span
lang=EN-US>.<br>
-24 : </span>使用模式<span lang=EN-US>0 2,</span>绑定<span lang=EN-US>64</span>位进程窗口时出现<span
lang=EN-US>,</span>因为安全软件拦截插件运行释放的<span lang=EN-US>EXE.<br>
-25 : </span>使用模式<span lang=EN-US>0 2,</span>绑定<span lang=EN-US>64</span>位进程窗口时出现<span
lang=EN-US>,</span>因为安全软件拦截插件运行释放的<span lang=EN-US>EXE.<br>
-26 : </span>使用模式<span lang=EN-US>0 2,</span>绑定<span lang=EN-US>64</span>位进程窗口时出现<span
lang=EN-US>, </span>因为目标窗口有保护<span lang=EN-US>. </span>常见于<span lang=EN-US>win7</span>以上系统<span
lang=EN-US>.</span>或者有安全软件拦截插件<span lang=EN-US style='color:fuchsia'>.</span><span
style='color:fuchsia'>解决办法<span lang=EN-US>: </span>关闭所有安全软件，然后再重新尝试<span
lang=EN-US>. </span>如果还不行就可以肯定是目标窗口有特殊保护<span lang=EN-US>.<br>
</span></span><span lang=EN-US>-27 : </span>绑定<span lang=EN-US>64</span>位进程窗口时出现，因为使用了不支持的模式，目前暂时只支持模式<span
lang=EN-US>0 2 11 13 101 103<br>
-28 : </span>绑定<span lang=EN-US>32</span>位进程窗口时出现，因为使用了不支持的模式，目前暂时只支持模式<span
lang=EN-US>0 2 11 13 101 103<br>
-38 : </span>是用了大于<span lang=EN-US>2</span>的绑定模式<span lang=EN-US>,</span>并且使用了<span
lang=EN-US>dx.public.inject.c</span>时，分配内存失败<span lang=EN-US>. </span>可以考虑开启<span
lang=EN-US>memory</span>系列盾来尝试<span lang=EN-US>.<br>
-39 : </span>是用了大于<span lang=EN-US>2</span>的绑定模式<span lang=EN-US>,</span>并且使用了<span
lang=EN-US>dx.public.inject.c</span>时的异常错误<span lang=EN-US>. </span>可以联系我解决<span
lang=EN-US>.<br>
-40 : </span>是用了大于<span lang=EN-US>2</span>的绑定模式<span lang=EN-US>,</span>并且使用了<span
lang=EN-US>dx.public.inject.c</span>时<span lang=EN-US>, </span>写入内存失败<span
lang=EN-US>. </span>可以考虑开启<span lang=EN-US>memory</span>系列盾来尝试<span lang=EN-US>.<br>
-41 : </span>是用了大于<span lang=EN-US>2</span>的绑定模式<span lang=EN-US>,</span>并且使用了<span
lang=EN-US>dx.public.inject.c</span>时的异常错误<span lang=EN-US>. </span>可以联系我解决<span
lang=EN-US>.<br>
-42 : </span>绑定时<span lang=EN-US>,</span>创建映射内存失败<span lang=EN-US>. </span>这是个异常错误<span
lang=EN-US>. </span>一般不会出现<span lang=EN-US>. </span>如果出现了，检查下代码是不是有同个对象同时绑定的情况<span
lang=EN-US>.</span>还有可能是你的进程有句柄泄露导致无法创建句柄会出这个错误<span lang=EN-US>.<br>
-43 : </span>绑定时<span lang=EN-US>,</span>映射内存失败<span lang=EN-US>. </span>这是个异常错误<span
lang=EN-US>. </span>一般不会出现<span lang=EN-US>. </span><span style='color:fuchsia'>如果出现了，一般是你的进程内存不足<span
lang=EN-US>,</span>检查下你的进程是不是内存泄漏了<span lang=EN-US>. <br>
</span></span><span lang=EN-US>-44 : </span>无效的参数<span lang=EN-US>,</span>通常是传递了不支持的参数<span
lang=EN-US>.<br>
-45 : </span>绑定时<span lang=EN-US>,</span>创建互斥信号失败<span lang=EN-US>. </span>这个是一场错误<span
lang=EN-US>. </span>一般不会出现<span lang=EN-US>. </span><span style='color:fuchsia'>如果出现了检查进程是否有句柄泄漏的情况<span
lang=EN-US>.</span></span><span lang=EN-US></span></span></p>

<p><span lang=EN-US style='font-size:13.5pt'>-100 : </span><span
style='font-size:13.5pt'>调用读写内存函数后，发现无效的窗口句柄<span lang=EN-US><br>
-101 : </span>读写内存函数失败<span lang=EN-US><br>
-200 : AsmCall</span>失败<span lang=EN-US><br>
-202 : AsmCall</span>平台兼容问题<span lang=EN-US>.</span>联系我解决<span lang=EN-US>.</span></span></p>

<p><span class=style21><span style='font-size:13.5pt'>示例<span lang=EN-US>:</span></span></span><span
lang=EN-US style='font-size:13.5pt'></span></p>

<p><span lang=EN-US style='font-size:13.5pt'>TracePrint dm.GetLastError()<br
style='mso-special-character:line-break'>
<br style='mso-special-character:line-break'>
</span></p>

<p><span style='font-size:13.5pt;color:fuchsia'>注<span lang=EN-US>: </span>此函数必须紧跟上一句函数调用，中间任何的语句调用都会改变这个值<span
lang=EN-US>.</span></span></p>

<p><span lang=EN-US style='font-size:13.5pt'>&nbsp;</span></p>

</div>

</body>

</html>
