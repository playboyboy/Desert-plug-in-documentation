<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=gb2312">
<meta name=ProgId content=Word.Document>


<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:宋体;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:SimSun;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:515 680460288 22 0 262145 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:1;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:0 0 0 0 0 0;}
@font-face
	{font-family:"\@宋体";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:515 680460288 22 0 262145 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-unhide:no;
	mso-style-link:"页眉 Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	tab-stops:center 207.65pt right 415.3pt;
	layout-grid-mode:char;
	border:none;
	mso-border-bottom-alt:solid windowtext .75pt;
	padding:0cm;
	mso-padding-alt:0cm 0cm 1.0pt 0cm;
	font-size:9.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-unhide:no;
	mso-style-link:"页脚 Char";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:center 207.65pt right 415.3pt;
	layout-grid-mode:char;
	font-size:9.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;}
a:link, span.MsoHyperlink
	{mso-style-unhide:no;
	color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-unhide:no;
	color:purple;
	text-decoration:underline;
	text-underline:single;}
p
	{mso-style-unhide:no;
	mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-unhide:no;
	mso-style-link:"批注框文本 Char";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:9.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;}
span.Char
	{mso-style-name:"页眉 Char";
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:页眉;
	mso-ansi-font-size:9.0pt;
	mso-bidi-font-size:9.0pt;
	font-family:宋体;
	mso-ascii-font-family:宋体;
	mso-fareast-font-family:宋体;
	mso-hansi-font-family:宋体;
	mso-bidi-font-family:宋体;}
span.Char0
	{mso-style-name:"页脚 Char";
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:页脚;
	mso-ansi-font-size:9.0pt;
	mso-bidi-font-size:9.0pt;
	font-family:宋体;
	mso-ascii-font-family:宋体;
	mso-fareast-font-family:宋体;
	mso-hansi-font-family:宋体;
	mso-bidi-font-family:宋体;}
p.style1, li.style1, div.style1
	{mso-style-name:style1;
	mso-style-unhide:no;
	mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;
	color:blue;
	font-weight:bold;}
span.style11
	{mso-style-name:style11;
	mso-style-unhide:no;
	color:blue;
	font-weight:bold;}
span.Char1
	{mso-style-name:"批注框文本 Char";
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:批注框文本;
	mso-ansi-font-size:9.0pt;
	mso-bidi-font-size:9.0pt;
	font-family:宋体;
	mso-ascii-font-family:宋体;
	mso-fareast-font-family:宋体;
	mso-hansi-font-family:宋体;
	mso-bidi-font-family:宋体;}
.MsoChpDefault
	{mso-style-type:export-only;
	mso-default-props:yes;
	font-size:10.0pt;
	mso-ansi-font-size:10.0pt;
	mso-bidi-font-size:10.0pt;
	mso-ascii-font-family:"Times New Roman";
	mso-hansi-font-family:"Times New Roman";
	mso-font-kerning:0pt;}
 /* Page Definitions */
 
@page Section1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:42.55pt;
	mso-footer-margin:49.6pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>

</head>

<body lang=ZH-CN link=blue vlink=purple style='tab-interval:21.0pt'>

<div class=Section1>

<p class=style1><span style='font-size:13.5pt'>函数简介<span lang=EN-US>:</span></span></p>

<p><span style='font-size:13.5pt'>针对部分检测措施的保护盾<span lang=EN-US>.<span
style='mso-spacerun:yes'>&nbsp; </span></span><span style='color:fuchsia'>前面有五角星的表示同时支持<span
lang=EN-US>32</span>位和<span lang=EN-US>64</span>位<span lang=EN-US>,</span>否则就仅支持<span
lang=EN-US>64</span>位<span lang=EN-US>. <br>
</span>驱动功能支持的系统版本号为<span lang=EN-US>(win7/win8/win8.1/win10(10240)/win10(10586)/win10(14393)/win10(15063)/win10(16299)/win10(17134)/win10(17763)/win10(18362)/win10(18363)/win10(19041)/win10(19042)
/win10(19043)/win10(19044)/win10(19045)/win11(22000)/win11(22621)/win11(22631)<br>
</span>不支持所有的预览版本<span lang=EN-US>,</span>仅仅支持正式版本<span lang=EN-US>.</span></span></span></p>

<p><span style='font-size:13.5pt;color:fuchsia'>新点的<span lang=EN-US>WIN10</span>和<span
lang=EN-US>WIN11</span>必须要关闭内核隔离<span lang=EN-US>.</span>否则会无法加载驱动<span
lang=EN-US>,</span>或者加载某些功能蓝屏<span lang=EN-US>.</span></span></p>

<p><span class=style11><span style='font-size:13.5pt'>函数原型<span lang=EN-US>:</span></span></span><span
lang=EN-US style='font-size:13.5pt'><br>
<br>
long DmGuard(enable,type)</span></p>

<p><span class=style11><span style='font-size:13.5pt'>参数定义<span lang=EN-US>:</span></span><span
lang=EN-US></span></span></p>

<p><span lang=EN-US style='font-size:13.5pt'>enable </span><span
style='font-size:13.5pt;color:maroon'>整形数<span lang=EN-US>: <br>
<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span lang=EN-US style='font-size:13.5pt'>0</span><span
style='font-size:13.5pt'>表示关闭保护盾<span lang=EN-US>(</span><span
style='color:fuchsia'>仅仅对<span lang=EN-US>memory memory2 memory3 memory4 b2 b3</span>起作用</span><span
lang=EN-US>)<br>
<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>1</span>表示打开保护盾<span lang=EN-US></span></span></p>

<p style='margin-left:81.0pt;text-indent:-81.0pt;mso-char-indent-count:-6.0'><span
lang=EN-US style='font-size:13.5pt'>type </span><span style='font-size:13.5pt;
color:gray'>字符串</span><span lang=EN-US style='font-size:13.5pt'>: </span><span
style='font-size:13.5pt'>参数具体内容可以是以下任意一个<span lang=EN-US>.<br>
<span style='color:red'><span style='mso-spacerun:yes'>&nbsp;</span></span></span><span
style='color:red'>★</span><span lang=EN-US>&quot;np&quot; : </span>这个是防止<span
lang=EN-US>NP</span>检测<span lang=EN-US>(</span><span style='color:fuchsia'>这个盾已经过时<span
lang=EN-US>,</span>不建议使用</span><span lang=EN-US>).<br>
<span style='color:red'><span style='mso-spacerun:yes'>&nbsp;</span></span></span><span
style='color:red'>★</span><span lang=EN-US>&quot;memory&quot; : </span>这个保护内存系列接口和汇编接口可以正常运行<span
lang=EN-US>.<span style='color:fuchsia'> (</span></span><span style='color:
fuchsia'>此模式需要加载驱动<span lang=EN-US>)<br>
<span style='mso-spacerun:yes'>&nbsp;</span></span></span><span
style='color:red'>★</span><span lang=EN-US>&quot;memory2&quot; : </span>这个保护内存系列接口和汇编接口可以正常运行<span
lang=EN-US>.<span style='color:fuchsia'> (</span></span><span style='color:
fuchsia'>此模式需要加载驱动<span lang=EN-US>)<br>
<span style='mso-spacerun:yes'>&nbsp;</span></span></span><span lang=EN-US>&quot;memory3
pid addr_start addr_end&quot; : </span>这个保护内存系列接口和汇编接口可以正常运行<span lang=EN-US>.pid</span>表示要操作内存的进程<span
lang=EN-US>ID,</span>指定了以后<span lang=EN-US>,</span>所有内存系列接口仅能对此<span
lang=EN-US>pid</span>进程进行操作<span lang=EN-US>,</span>其他进程无效<span lang=EN-US>. </span>但此盾速度较快。<span
lang=EN-US>addr_start</span>表示起始地址<span lang=EN-US>(</span>此参数可以忽略<span
lang=EN-US>),addr_end</span>表示结束地址<span lang=EN-US>(</span>此参数可以忽略<span
lang=EN-US>). </span>另外，如果你发现有地址读写不到，可以尝试重新调用一次此盾<span lang=EN-US>.</span>此盾是对指定的<span
lang=EN-US>PID</span>，指定的地址范围做快照<span lang=EN-US>.<span style='color:fuchsia'>
(</span></span><span style='color:fuchsia'>此模式需要加载驱动<span lang=EN-US>)<br>
<span style='mso-spacerun:yes'>&nbsp;</span></span></span><span lang=EN-US>&quot;memory4&quot;
: </span>这个保护内存系列接口和汇编接口可以正常运行<span lang=EN-US>.<span style='color:fuchsia'> (</span></span><span
style='color:fuchsia'>此模式需要加载驱动<span lang=EN-US>)<br>
<span style='mso-spacerun:yes'>&nbsp;</span></span></span><span lang=EN-US>&quot;memory5&quot;
: </span>这个保护内存系列接口和汇编接口可以正常运行<span lang=EN-US>.<span style='color:fuchsia'> (</span></span><span
style='color:fuchsia'>此模式需要加载驱动<span lang=EN-US>,</span>直接读写物理内存<span
lang=EN-US>,</span>所以对于地址空间不在物理内存里的地址<span lang=EN-US>,</span>就会无法读写<span
lang=EN-US>.)<br>
<span style='mso-spacerun:yes'>&nbsp;</span></span></span><span lang=EN-US>&quot;memory6&quot;
: </span>这个保护内存系列接口和汇编接口可以正常运行<span lang=EN-US>.<span style='color:fuchsia'> (</span></span><span
style='color:fuchsia'>此模式是<span lang=EN-US>memory5</span>的加强版本<span lang=EN-US>,</span>需要加载驱动<span
lang=EN-US>,</span>直接读写物理内存<span lang=EN-US>,</span>所以对于地址空间不在物理内存里的地址<span
lang=EN-US>,</span>就会无法读写<span lang=EN-US>.)<br>
<span style='mso-spacerun:yes'>&nbsp;</span></span></span><span lang=EN-US>&quot;phide
[pid]&quot; : </span>隐藏指定进程<span lang=EN-US>,</span>保护指定进程以及进程内的窗口不被非法访问<span
lang=EN-US>. pid</span>为可选参数<span lang=EN-US>.</span>如果不指定<span lang=EN-US>pid</span>，默认保护当前进程<span
lang=EN-US>.<span style='color:fuchsia'> (</span></span><span style='color:
fuchsia'>此模式需要加载驱动<span lang=EN-US>,</span>目前仅支持<span lang=EN-US>32</span>位系统<span
lang=EN-US>)</span></span><span lang=EN-US><br>
<span style='mso-spacerun:yes'>&nbsp;</span>&quot;phide2 [pid]&quot; : </span>同<span
lang=EN-US>phide. </span>只是进程不隐藏<span lang=EN-US>(</span>可在任务管理器中操作<span
lang=EN-US>) <span style='color:fuchsia'>(</span></span><span style='color:
fuchsia'>此模式需要加载驱动<span lang=EN-US>,</span>目前仅支持<span lang=EN-US>32</span>位系统<span
lang=EN-US>)</span></span><span lang=EN-US><br>
<span style='mso-spacerun:yes'>&nbsp;</span>&quot;phide3 [pid]&quot; : </span>只隐藏进程<span
lang=EN-US>(</span>在任务管理器看不到<span lang=EN-US>),</span>但不保护进程和窗口<span
lang=EN-US>. <span style='color:fuchsia'>(</span></span><span style='color:
fuchsia'>此模式需要加载驱动<span lang=EN-US>,</span>目前仅支持<span lang=EN-US>32</span>位系统<span
lang=EN-US>)</span></span><span lang=EN-US><br>
<span style='mso-spacerun:yes'>&nbsp;</span></span><span style='color:red'>★</span><span
lang=EN-US>&quot;display2&quot; : </span>同<span lang=EN-US>display,</span>但此模式用在一些极端的场合<span
lang=EN-US>. </span>比如用任何截图软件也无法截图时，可以考虑这个盾<span lang=EN-US>.<br>
<br>
<span style='mso-spacerun:yes'>&nbsp;</span></span><span style='color:red'>★</span><span
lang=EN-US>&quot;display3 &lt;hwnd&gt;&quot; : </span>此盾可以保护当前进程指定的窗口<span
lang=EN-US>(</span>和子窗口<span lang=EN-US>)</span>，无法被用正常手段截图<span lang=EN-US>.
hwnd</span>是必选参数<span lang=EN-US>. </span>并且必须是和当前调用进程相同进程的顶级窗口<span
lang=EN-US>.<span style='color:fuchsia'> </span></span><span style='color:fuchsia'>此盾有限制<span
lang=EN-US>,</span>具体查看下方的备注<span lang=EN-US>.</span></span></span></p>

<p style='margin-left:84.0pt'><span lang=EN-US style='font-size:13.5pt'>&quot;display4
&lt;hwnd&gt;&quot; : </span><span style='font-size:13.5pt'>此盾可以保护指定的窗口<span
lang=EN-US>(</span>和子窗口<span lang=EN-US>)</span>，无法被用正常手段截图<span lang=EN-US>.
hwnd</span>是必选参数<span lang=EN-US>. </span>并且必须是顶级窗口<span lang=EN-US>.<span
style='color:fuchsia'> (</span></span><span style='color:fuchsia'>此模式需要加载驱动<span
lang=EN-US>,</span>此盾和<span lang=EN-US>display3</span>类似<span lang=EN-US>. </span>只是使用了驱动来实现<span
lang=EN-US>.</span>并且没有<span lang=EN-US>display3</span>的同进程限制<span lang=EN-US>.
</span>在高版本的<span lang=EN-US>WIN10</span>上效果会更好<span lang=EN-US>.)</span></span><span
lang=EN-US><br>
<br>
<span style='mso-spacerun:yes'>&nbsp;</span></span><span style='color:red'>★</span><span
lang=EN-US>&quot;block [pid]&quot; : </span>保护指定进程不被非法访问<span lang=EN-US>. pid</span>为可选参数<span
lang=EN-US>.</span>如果不指定<span lang=EN-US>pid</span>，默认保护当前进程<span lang=EN-US>,</span>另种实现方式<span
lang=EN-US>.</span><span style='color:fuchsia'>（此模式需要加载驱动<span lang=EN-US>,</span>另外此盾在<span
lang=EN-US>64</span>位系统下无法隐藏驱动<span lang=EN-US>,</span>调用后会让驱动无法隐藏<span
lang=EN-US>,</span>所以<span lang=EN-US>64</span>位系统下<span lang=EN-US>,</span>不太建议使用此盾<span
lang=EN-US>)<br>
<br>
<span style='mso-spacerun:yes'>&nbsp;</span></span></span><span
style='color:red'>★</span><span lang=EN-US>&quot;b2 [pid]&quot; : </span>保护指定进程不被非法访问<span
lang=EN-US>. pid</span>为可选参数<span lang=EN-US>.</span>如果不指定<span lang=EN-US>pid</span>，默认保护当前进程<span
lang=EN-US>,</span>另种实现方式<span lang=EN-US>.<span style='color:fuchsia'>(</span></span><span
style='color:fuchsia'>此模式需要加载驱动<span lang=EN-US>),</span>另外<span lang=EN-US>,b2</span>盾有副作用，会导致任何和音频输出的函数无声音<span
lang=EN-US>(</span>比如，<span lang=EN-US>Play</span>和<span lang=EN-US>Beep</span>函数，或者类似此函数实现的方式<span
lang=EN-US>. </span>解决办法是另外创建一个进程用来播放音乐<span lang=EN-US>). </span>另外要特别注意，个别系统上，会出现保护进程退出时，导致系统蓝屏，解决办法是在进程结束前，关闭<span
lang=EN-US>b2</span>盾即可<span lang=EN-US>. </span>另外测试下来新版本的<span lang=EN-US>WIN10</span>也会触发<span
lang=EN-US>pg.<br>
<br>
<span style='mso-spacerun:yes'>&nbsp; </span></span></span><span lang=EN-US>&quot;b3
[pid]&quot; : </span>保护指定进程不被非法访问<span lang=EN-US>. pid</span>为可选参数<span
lang=EN-US>.</span>如果不指定<span lang=EN-US>pid</span>，默认保护当前进程<span lang=EN-US>,</span>另种实现方式<span
lang=EN-US>.<span style='color:fuchsia'>(</span></span><span style='color:fuchsia'>此模式需要加载驱动<span
lang=EN-US>),</span>另外<span lang=EN-US>,b3</span>盾有副作用，会导致无法创建线程，无法结束线程<span
lang=EN-US>,</span>无法操作某些系统<span lang=EN-US>API(</span>比如打开文件对话框<span
lang=EN-US>)</span>，无法绑定目标窗口等等<span lang=EN-US>,</span>解决办法是，临时关闭<span
lang=EN-US>b3</span>，进行你的操作<span lang=EN-US>,</span>然后再打开<span lang=EN-US>b3</span>。<span
lang=EN-US> <br>
<br>
</span></span><span lang=EN-US style='color:red'><span
style='mso-spacerun:yes'>&nbsp; </span></span><span lang=EN-US>&quot;f1
[pid]&quot; : </span>把当前进程伪装成<span lang=EN-US>pid</span>指定的进程，可以保护进程路径无法被获取到<span
lang=EN-US>.</span>如果省略<span lang=EN-US>pid</span>参数，则伪装成<span lang=EN-US>svchost.exe</span>进程<span
lang=EN-US>. <span style='color:fuchsia'>(</span></span><span style='color:
fuchsia'>此模式需要加载驱动<span lang=EN-US>),</span>另外，简单游平台专用版本无法使用此盾，原因是和简单游有冲突。<span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp; </span></span>还有，使用此盾后，别人无法获取到你的进程的真实路径，但自己也同样无法获取，所以如果要获取真实路径，请务必在获取到路径后保存，再调用此盾<span
lang=EN-US>. pid</span>参数如果有效，那必须是一个真实存在的<span lang=EN-US>pid,</span>否则会失败<span
lang=EN-US>.</span>如果被伪装的进程关闭了，那么当前进程也会立刻失去伪装<span lang=EN-US>. </span>还有最重要的一点，伪装的进程和目的进程，占用内存要差不多，最好目的进程占用内存要大于被伪装进程，否则可能会导致进程崩溃<span
lang=EN-US>!!!<span style='mso-spacerun:yes'>&nbsp; </span></span>有些编译平台编译出的程序<span
lang=EN-US>,</span>貌似开这个盾会导致异常，可以尝试<span lang=EN-US>f2</span>盾<span lang=EN-US>.<br>
<br>
<span style='mso-spacerun:yes'>&nbsp;</span></span></span><span
style='color:red'>★ </span><span lang=EN-US>&quot;d1 [cls][add dll_name
exact]&quot; : </span>阻止指定的<span lang=EN-US>dll</span>加载到本进程<span lang=EN-US>.</span>这里的<span
lang=EN-US>dll_name</span>不区分大小写<span lang=EN-US>.<span style='color:fuchsia'> </span></span><span
style='color:fuchsia'>具体调用方法看下面的例子<span lang=EN-US>.</span></span><span
lang=EN-US> <br>
<br>
<span style='mso-spacerun:yes'>&nbsp;</span></span><span style='color:red'>★ </span><span
lang=EN-US>&quot;f2 &lt;target_process&gt; &lt;protect_process&gt;&quot; :</span>把<span
lang=EN-US>protect_process</span>伪装成<span lang=EN-US>target_process</span>运行<span
lang=EN-US>. </span>此盾会加载<span lang=EN-US>target_process</span>运行<span
lang=EN-US>,</span>然后用<span lang=EN-US>protect_process</span>来替换<span
lang=EN-US>target_process,</span>从而达到伪装自身的目的<span lang=EN-US>.</span>此盾不加载驱动<span
lang=EN-US>. </span>这个<span lang=EN-US>protect_process</span>也可以使用内存地址的形式，不用路径<span
lang=EN-US>. </span>写法是这样<span lang=EN-US>&lt;addr,size&gt;,addr</span>是内存地址<span
lang=EN-US>,size</span>是大小<span lang=EN-US>,</span>都是<span lang=EN-US>10</span>进制<span
lang=EN-US>. </span>后面有例子 <span lang=EN-US style='color:fuchsia'>(</span><span
style='color:fuchsia'>使用此盾后，别人无法获取到你的进程的真实路径，但自己也同样无法获取，所以如果要获取真实路径，请务必在获取到路径后保存后<span
lang=EN-US>,</span>通过共享内存等方式传递给保护进程<span lang=EN-US>). </span>返回值为伪装后的进程<span
lang=EN-US>ID</span></span><span lang=EN-US><br>
<span style='color:fuchsia'><br>
</span>&quot;hm module unlink&quot; : </span>防止当前进程中的指定模块被非法访问<span lang=EN-US>.
module</span>为模块名<span lang=EN-US>(</span>为<span lang=EN-US>0</span>表示<span
lang=EN-US>EXE</span>模块<span lang=EN-US>),</span>比如<span lang=EN-US>dm.dll </span>。<span
lang=EN-US> unlink</span>取<span lang=EN-US>0</span>或者<span lang=EN-US>1</span>，<span
lang=EN-US>1</span>表示是否把模块在进程模块链表中擦除<span lang=EN-US>,0</span>表示不擦除<span
lang=EN-US>.<span style='color:fuchsia'>(</span></span><span style='color:fuchsia'>此模式需要加载驱动<span
lang=EN-US>) <br>
<br>
</span></span><span lang=EN-US>&quot;inject mode pid &lt;param1&gt;
&lt;param2&gt;&quot; : </span>注入指定的<span lang=EN-US>DLL</span>到指定的进程中<span
lang=EN-US>. mode</span>表示注入模式<span lang=EN-US>. pid</span>表示需要注入进去的进程<span
lang=EN-US>ID . param1</span>和<span lang=EN-US>param2</span>参数含义根据<span
lang=EN-US>mode</span>决定<span lang=EN-US>.<span style='color:fuchsia'>(</span></span><span
style='color:fuchsia'>此模式需要加载驱动<span lang=EN-US>)<br>
<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span></span></span><span
lang=EN-US>mode</span>取值<span lang=EN-US>0 1 2 3</span>，具体含义如下<span lang=EN-US>:<br>
<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>0: </span>此时<span
lang=EN-US>param1</span>表示需要注入的<span lang=EN-US>dll</span>全路径<span lang=EN-US>.
param2</span>表示为<span lang=EN-US>&lt;unlink erase&gt;.</span>注入方式是通过创建线程注入<span
lang=EN-US>.<br>
<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>unlink(</span>取值<span
lang=EN-US>0</span>和<span lang=EN-US>1)</span>，表示是否从进程模块链表中断链<span lang=EN-US>,</span>取<span
lang=EN-US>1</span>表示断链<span lang=EN-US>.<br>
<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>erase(</span>取值<span lang=EN-US>0</span>和<span lang=EN-US>1),</span>表示是否擦除<span
lang=EN-US>PE</span>头<span lang=EN-US>,</span>取<span lang=EN-US>1</span>表示擦除<span
lang=EN-US>. <br>
<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>1: </span>此时<span
lang=EN-US>param1</span>表示需要注入的<span lang=EN-US>dll</span>全路径<span lang=EN-US>.
param2</span>表示为<span lang=EN-US>&lt;unlink erase&gt;.</span>注入方式是通过<span
lang=EN-US>APC</span>注入<span lang=EN-US>.<br>
<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>unlink(</span>取值<span lang=EN-US>0</span>和<span lang=EN-US>1)</span>，表示是否从进程模块链表中断链<span
lang=EN-US>,</span>取<span lang=EN-US>1</span>表示断链<span lang=EN-US>.<br>
<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>erase(</span>取值<span lang=EN-US>0</span>和<span lang=EN-US>1),</span>表示是否擦除<span
lang=EN-US>PE</span>头<span lang=EN-US>,</span>取<span lang=EN-US>1</span>表示擦除<span
lang=EN-US>. <br>
<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>2: </span>此时<span
lang=EN-US>param1</span>表示需要注入的<span lang=EN-US>dll</span>全路径<span lang=EN-US>.
param2</span>表示为<span lang=EN-US>&lt;hidevad erase nothread noimportdll&gt;.</span>注入方式是内存加载<span
lang=EN-US>DLL.<br>
<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>hidevad(</span>取值<span lang=EN-US>0</span>和<span lang=EN-US>1),</span>表示是否擦除<span
lang=EN-US>vad,</span>取<span lang=EN-US>1</span>表示擦除<span lang=EN-US>. </span><span
style='color:fuchsia'>注意<span lang=EN-US>,</span>此参数在对部分系统上<span lang=EN-US>,</span>对<span
lang=EN-US>64</span>位进程注入时<span lang=EN-US>,</span>会导致进程崩溃<span lang=EN-US>.</span></span><span
lang=EN-US><br>
<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>erase(</span>取值<span lang=EN-US>0</span>和<span lang=EN-US>1),</span>表示是否擦除<span
lang=EN-US>PE</span>头<span lang=EN-US>,</span>取<span lang=EN-US>1</span>表示擦除<span
lang=EN-US>. <br>
<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>nothread(</span>取值<span lang=EN-US>0</span>和<span lang=EN-US>1),</span>表示是否在注入时创建线程<span
lang=EN-US>,</span>取<span lang=EN-US>1</span>表示不创建<span lang=EN-US>. </span><span
style='color:fuchsia'>选<span lang=EN-US>1</span>表示使用<span lang=EN-US>APC</span>注入<span
lang=EN-US>. </span>选<span lang=EN-US>0</span>表示使用线程注入<span lang=EN-US>.</span></span><span
lang=EN-US><br>
<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>noimportdll(</span>取值<span lang=EN-US>0</span>和<span lang=EN-US>1),</span>表示是否再次加载此<span
lang=EN-US>DLL</span>中的导入表<span lang=EN-US>DLL,</span>取<span lang=EN-US>1</span>表示不加载<span
lang=EN-US>,</span>直接使用<span lang=EN-US>.</span>除非你真的理解这个参数的意义<span lang=EN-US>,</span>否则不要轻易设置为<span
lang=EN-US>1,</span>会导致进程崩溃<span lang=EN-US>.<br>
<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>3: </span>此时<span
lang=EN-US>param1</span>表示需要注入的<span lang=EN-US>dll</span>的地址和大小<span
lang=EN-US>. param1</span>表示为<span lang=EN-US>&lt;addr,size&gt;. param2</span>表示为<span
lang=EN-US>&lt;hidevad erase nothread noimportdll&gt;.</span>注入方式是内存加载<span
lang=EN-US>DLL.<br>
<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>addr</span>表示<span
lang=EN-US>DLL</span>的起始地址<span lang=EN-US>,10</span>进制表示<span lang=EN-US>. </span><span
style='color:fuchsia'>这个同模式<span lang=EN-US>2.</span>只不过<span lang=EN-US>DLL</span>使用地址的方式来传递<span
lang=EN-US>.<br>
</span></span><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>size</span>表示<span
lang=EN-US>DLL</span>的大小，<span lang=EN-US>10</span>进制表示<span lang=EN-US><br>
<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>hidevad(</span>取值<span lang=EN-US>0</span>和<span lang=EN-US>1),</span><span
style='color:#FF33CC'>同模式<span lang=EN-US>2 </span></span><span lang=EN-US><br>
<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>erase(</span>取值<span lang=EN-US>0</span>和<span lang=EN-US>1),<span
style='color:#FF33CC'> </span></span><span style='color:#FF33CC'>同模式<span
lang=EN-US>2</span></span><span lang=EN-US><br>
<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>nothread(</span>取值<span lang=EN-US>0</span>和<span lang=EN-US>1),<span
style='color:#FF33CC'> </span></span><span style='color:#FF33CC'>同模式<span
lang=EN-US>2</span></span><span lang=EN-US><br>
<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>noimportdll(</span>取值<span lang=EN-US>0</span>和<span lang=EN-US>1),<span
style='color:#FF33CC'> </span></span><span style='color:#FF33CC'>同模式<span
lang=EN-US>2</span></span><span lang=EN-US><br>
<br>
<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span></span>以上几种注入模式<span
lang=EN-US>,</span>最隐蔽的是<span lang=EN-US>2</span>和<span lang=EN-US>3,</span>并且<span
lang=EN-US>param2</span>取为<span lang=EN-US>&lt;1,1,1,1&gt;. </span>可以自己测试使用<span
lang=EN-US>.<br>
<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span></span><span
style='color:fuchsia'>另外<span lang=EN-US>2</span>和<span lang=EN-US>3</span>对<span
lang=EN-US>DLL</span>是由要求的<span lang=EN-US>,</span>尽可能要让<span lang=EN-US>DLL</span>的导入表简单<span
lang=EN-US>.<span style='mso-spacerun:yes'>&nbsp; </span></span>也就是说尽可能不要让<span
lang=EN-US>DLL</span>依赖太多<span lang=EN-US>DLL</span>。越简单越好<span lang=EN-US>.</span></span><span
lang=EN-US></span></span></p>

<p style='margin-left:81.0pt;text-indent:-81.0pt;mso-char-indent-count:-6.0'><span
lang=EN-US style='font-size:13.5pt'><br>
&quot;del &lt;path&gt;&quot; :</span><span style='font-size:13.5pt'>强制删除指定的文件<span
lang=EN-US>. path</span>表示需要删除的文件的全路径<span lang=EN-US>. </span>当<span
lang=EN-US>path</span>为<span lang=EN-US>0</span>时<span lang=EN-US>,</span>表示为当前<span
lang=EN-US>dm.dll</span>的路径<span lang=EN-US>,</span>当<span lang=EN-US>path</span>为<span
lang=EN-US>1</span>时<span lang=EN-US>,</span>表示为当前<span lang=EN-US>EXE</span>的全路径<span
lang=EN-US>.<span style='color:fuchsia'>(</span></span><span style='color:fuchsia'>此模式需要加载驱动<span
lang=EN-US>)<br>
</span></span>其它后续开发<span lang=EN-US>.</span></span></p>

<p style='margin-left:81.0pt;text-indent:-81.0pt;mso-char-indent-count:-6.0'><span
lang=EN-US style='font-size:13.5pt'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&quot;</span><span
style='font-size:13.5pt;color:red'>★ </span><span lang=EN-US style='font-size:
13.5pt'>cl pid type name&quot;: </span><span style='font-size:13.5pt'>关闭指定进程中，对象名字中含有<span
lang=EN-US>name</span>的句柄<span lang=EN-US>. pid</span>表示进程<span lang=EN-US>PID.
type</span>表示需要关闭的句柄类型<span lang=EN-US>. </span>比如<span lang=EN-US>Section
Event Mutant</span>等<span lang=EN-US>. </span>具体的类型可以用<span lang=EN-US>pchunter</span>查看<span
lang=EN-US>.<br>
<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>name</span>表示需要查找的对象名<span lang=EN-US>. </span>注意<span lang=EN-US>type</span>和<span
lang=EN-US>name</span>都是大小写敏感的<span lang=EN-US>.</span></span></p>

<p style='margin-left:81.0pt;text-indent:-81.0pt;mso-char-indent-count:-6.0'><span
lang=EN-US style='font-size:13.5pt'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&quot;hl
[pid]&quot; : </span><span style='font-size:13.5pt'>隐藏指定进程中的句柄<span lang=EN-US>,</span>无法用正常手段获取到<span
lang=EN-US>. pid</span>为可选参数<span lang=EN-US>.</span>如果不指定<span lang=EN-US>pid</span>，默认为当前进程<span
lang=EN-US>.<span style='color:fuchsia'> (</span></span><span style='color:
fuchsia'>此模式需要加载驱动<span lang=EN-US>,</span>另外此盾会在<span lang=EN-US>WIN10</span>上触发<span
lang=EN-US>pg</span>蓝屏<span lang=EN-US>.win10</span>系统必须过<span lang=EN-US>pg</span>才可以使用<span
lang=EN-US>)</span></span></span></p>

<p style='margin-left:81.0pt;text-indent:-81.0pt;mso-char-indent-count:-6.0'><span
lang=EN-US style='font-size:13.5pt;color:fuchsia'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-US style='font-size:13.5pt'>&quot;gr&quot; : </span><span
style='font-size:13.5pt'>开启句柄操作，具体查看<span lang=EN-US>DmGuardParams</span>相关说明<span
lang=EN-US>.<span style='color:fuchsia'> (</span></span><span style='color:
fuchsia'>此模式需要加载驱动<span lang=EN-US>)</span></span></span></p>

<p style='margin-left:81.0pt;text-indent:-81.0pt;mso-char-indent-count:-6.0'><span
lang=EN-US style='font-size:13.5pt;color:fuchsia'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-US style='font-size:13.5pt'>&quot;th&quot; : </span><span
style='font-size:13.5pt'>开启线程操作，具体查看<span lang=EN-US>DmGuardParams</span>相关说明<span
lang=EN-US>.<span style='color:fuchsia'> (</span></span><span style='color:
fuchsia'>此模式需要加载驱动<span lang=EN-US>)</span></span></span></p>

<p><span class=style11><span style='font-size:13.5pt'>返回值<span lang=EN-US>:</span></span></span><span
lang=EN-US style='font-size:13.5pt'><br>
<br>
</span><span style='font-size:13.5pt;color:maroon'>整形数<span lang=EN-US>:</span></span><span
lang=EN-US style='font-size:13.5pt'><br>
0 : </span><span style='font-size:13.5pt'>不支持的保护盾类型<span lang=EN-US><br>
1 : </span>成功<span lang=EN-US><br>
-1 : 32</span>位平台不支持<span lang=EN-US><br>
-2 : </span>驱动释放失败<span lang=EN-US>.<span style='color:fuchsia'>(</span></span><span
style='color:fuchsia'>可能原因是权限不够<span lang=EN-US>)</span></span><span
lang=EN-US> <br>
-3 : </span>驱动加载失败<span lang=EN-US>,</span>可能是权限不够<span lang=EN-US>. </span>参考<span
lang=EN-US>UAC</span>权限设置<span lang=EN-US>.</span>或者是被安全软件拦截<span lang=EN-US>. </span>如果是在<span
lang=EN-US>64</span>位系统下返回此错误，需要安装补丁<span lang=EN-US>KB3033929.</span></span></p>

<p style='text-indent:33.75pt;mso-char-indent-count:2.5'><span
style='font-size:13.5pt'>如果是<span lang=EN-US>WIN10 1607</span>之后的系统，出现这个错误，可<span
lang=EN-US><a href="../常见问题/64位系统如何加载驱动.htm"><span lang=EN-US><span lang=EN-US>参考这里</span></span></a></span></span></p>

<p style='text-indent:33.75pt;mso-char-indent-count:2.5'><span
style='font-size:13.5pt'>还有一个可能，如果使用了定制的插件，如果原先加载了老的驱动，那么新的定制可能会无法加载，返回<span
lang=EN-US>-3. </span>只需要重启系统即可<span lang=EN-US>.(</span><span
style='color:fuchsia'>必须是重启，不是关机再开机</span><span lang=EN-US>)<br>
-555 : f2</span>盾的返回值<span lang=EN-US>, protect_process</span>路径无法访问<span
lang=EN-US>.<br>
-666 : f2</span>盾的返回值<span lang=EN-US>, target_process</span>无法创建进程<span
lang=EN-US>.(</span>可能路径错误<span lang=EN-US>?)<br>
-777 : f2</span>盾的返回值<span lang=EN-US>,</span>其它异常错误<span lang=EN-US>.<br>
-<st1:chsdate IsROCDate="False" IsLunarDate="False" Day="6" Month="5"
Year="2004" w:st="on">4 -5 -6</st1:chsdate> </span>都是异常错误<span lang=EN-US>.<br>
-7: </span>一般是系统版本不支持导致<span lang=EN-US>,</span>用<span lang=EN-US>winver</span>可以查看系统内部版本号<span
lang=EN-US>. </span>驱动只支持正式发布的版本，所有预览版本都不支持<span lang=EN-US>.<br>
-8: </span>驱动加载失败<span lang=EN-US>. </span>检查要加载的盾需要的条件<span lang=EN-US>.<br>
-9 : </span>表示参数错误<span lang=EN-US>.<br>
-10 : </span>表示此盾的功能失败了<span lang=EN-US>.<br>
-11 : </span>表示分配内存失败<span lang=EN-US>.<br>
-14 : </span>无效的窗口句柄<span lang=EN-US><br>
-16 : </span>此功能依赖的驱动没有先启动<span lang=EN-US><br>
-20 : </span>此功能不可重复加载<span lang=EN-US><br>
-30 : </span>通信模式<span lang=EN-US>1</span>和<span lang=EN-US>2</span>出此错误是异常错误<span
lang=EN-US>.<br>
-31 : </span>通信模式<span lang=EN-US>1</span>和<span lang=EN-US>2</span>出此错误是异常错误<span
lang=EN-US>.<br>
-32 : </span>通信模式<span lang=EN-US>1</span>和<span lang=EN-US>2</span>出此错误是异常错误<span
lang=EN-US>.</span></span></p>

<p><span class=style11><span style='font-size:13.5pt'>示例<span lang=EN-US>:</span></span></span><span
lang=EN-US style='font-size:13.5pt'><br>
<br>
dm.DmGuard 1,&quot;np&quot;<br>
dm.DmGuard 1,&quot;memory&quot;<br>
dm.DmGuard 1,&quot;display2&quot;<br>
dm.DmGuard 1,&quot;block&quot;<br>
dm.DmGuard 1,&quot;block 1044&quot;<br>
dm.DmGuard 1,&quot;b2&quot;<br>
dm.DmGuard 1,&quot;b2 1044&quot;<br>
dm.DmGuard 0,&quot;b2&quot;<br>
dm.DmGuard 1,&quot;f1&quot;<br>
dm.DmGuard 1,&quot;f1 2358&quot;<br>
dm.DmGuard 1,&quot;f2 &lt;c:\windows\system32\calc.exe&gt;
&lt;d:\test\my.exe&gt;&quot;<br>
dm.DmGuard 1,&quot;f2 &lt;d:\test\my_cheate.exe&gt;
&lt;d:\test\my.exe&gt;&quot;<br>
dm.DmGuard 1,&quot;f2 &lt;d:\test\aaa.dat&gt; &lt;d:\test\my.exe&gt;&quot;<br>
dm.DmGuard 1,&quot;f2 &lt;c:\windows\system32\calc.exe&gt;
&lt;293478325735,234356&gt;&quot;<br>
dm.DmGuard 1,&quot;b3&quot;<br>
dm.DmGuard 1,&quot;b3 1044&quot;<br>
dm.DmGuard 0,&quot;b3&quot;<br>
dm.DmGuard 1,&quot;memory2&quot;<br>
dm.DmGuard 1,&quot;memory3 1044&quot;<br>
dm.DmGuard 1,&quot;hm dm.dll 1&quot;<br>
dm.DmGuard 1,&quot;hm dm.dll 0&quot;<br>
// </span><span style='font-size:13.5pt'>这个是隐藏<span lang=EN-US>exe</span>模块<span
lang=EN-US><br>
dm.DmGuard 1,&quot;hm 0 1&quot; <br>
dm.DmGuard 1,&quot;hm xxx.dll 1&quot;<br>
dm.DmGuard 1,&quot;inject 0 1044 &lt;c:\test.dll&gt; &lt;1 1&gt;&quot;<br>
dm.DmGuard 1,&quot;inject 1 1044 &lt;c:\test.dll&gt; &lt;1 0&gt;&quot;<br>
dm.DmGuard 1,&quot;inject 2 1044 &lt;c:\test.dll&gt; &lt;1 1 1 0&gt;&quot;<br>
dm.DmGuard 1,&quot;inject 3 1044 &lt;239458,568&gt; &lt;1 1 1 1&gt;&quot;<br>
dm.DmGuard 1,&quot;del &lt;c:\test.dll&gt;&quot;<br>
dm.DmGuard 1,&quot;del &lt;0&gt;<br>
dm.DmGuard 1,&quot;del &lt;1&gt;&quot;<br>
dm.DmGuard 1,&quot;display3 1188&quot;<br>
dm.DmGuard 0,&quot;display3 1188&quot;<br>
// </span>关闭进程<span lang=EN-US>1024</span>中<span lang=EN-US>,</span>类型为<span
lang=EN-US>Mutant</span>的，名字中含有<span lang=EN-US>test123</span>的句柄<span
lang=EN-US>.<br>
dm.DmGuard 1,&quot;cl 1024 Mutant test123&quot;<br>
// </span>关闭进程<span lang=EN-US>1024</span>中<span lang=EN-US>,</span>类型为<span
lang=EN-US>Event</span>的，名字中含有<span lang=EN-US>abc</span>的句柄<span lang=EN-US>.<br>
dm.DmGuard 1,&quot;cl 1024 Event abc&quot;<br>
<br>
// </span>清除拦截列表<span lang=EN-US><br>
dm.DmGuard 1,&quot;d1 cls&quot;<br>
// </span>拦截<span lang=EN-US>dll</span>名字中含有<span lang=EN-US>antiphinshing</span>的所有<span
lang=EN-US>dll<br>
dm.DmGuard 1,&quot;d1 add antiphinshing 0&quot;<br>
// </span>拦截<span lang=EN-US>dll</span>名字完全等同于<span lang=EN-US>abc.dll</span>的<span
lang=EN-US>DLL</span>加载<span lang=EN-US><br>
dm.DmGuard 1,&quot;d1 add abc.dll 1&quot;<br>
// </span>拦截所有<span lang=EN-US>DLL</span>的加载<span lang=EN-US><br>
dm.DmGuard 1,&quot;d1 add all&quot;</span></span></p>

<p><span lang=EN-US style='font-size:13.5pt'>// </span><span style='font-size:
13.5pt'>隐藏句柄<span lang=EN-US><br>
dm.DmGuard 1,&quot;hl&quot;<br>
dm.DmGuard 1,&quot;hl 1024&quot;</span></span></p>

<p><span lang=EN-US style='font-size:13.5pt'>// </span><span style='font-size:
13.5pt'>开启句柄操作<span lang=EN-US><br>
dm.DmGuard 1,&quot;gr&quot;</span></span></p>

<p><span style='font-size:13.5pt;color:fuchsia'>注<span lang=EN-US> : </span>此函数最好在目标进程打开之前调用即可。调用一次即可。
尽量保证此函数第一个被执行，以免和其他驱动冲突<span lang=EN-US>.</span>此函数最好在绑定之前执行<span lang=EN-US>.<br>
</span>可多个组合调用<span lang=EN-US>.<br>
</span>另外<span lang=EN-US>np</span>和<span lang=EN-US>display2</span>盾有点特殊<span
lang=EN-US>,</span>必须保证调用此对象的<span lang=EN-US>dm</span>对象一直处于存在状态<span
lang=EN-US>,</span>不可以释放<span lang=EN-US>. </span>一旦释放<span lang=EN-US>,</span>等于没调用<span
lang=EN-US>.</span>比如有些人喜欢在按键的<span lang=EN-US>OnScriptLoad</span>中调用这<span
lang=EN-US>2</span>个盾<span lang=EN-US>,</span>实际上<span lang=EN-US>OnScriptLoad</span>执行完以后<span
lang=EN-US>,</span>对象会自动被释放掉<span lang=EN-US>.<br>
f2</span>盾特别注意<span lang=EN-US>,</span></span><span lang=EN-US
style='font-size:13.5pt'> <span style='color:fuchsia'>protect_process</span></span><span
style='font-size:13.5pt;color:fuchsia'>为你的真正需要运行的程序<span lang=EN-US>,</span></span><span
lang=EN-US style='font-size:13.5pt'> <span style='color:fuchsia'>target_process</span></span><span
style='font-size:13.5pt;color:fuchsia'>为任意一个可执行的<span lang=EN-US>exe,</span>最后<span
lang=EN-US>protect_process</span>被伪装成<span lang=EN-US>target_process</span>运行<span
lang=EN-US>. </span>但由于兼容性问题<span lang=EN-US>, target_process</span>的选取并不是任意的<span
lang=EN-US>,</span>请自己做好测试<span lang=EN-US>. </span>有些<span lang=EN-US>target_process</span>会出现让你的程序<span
lang=EN-US>UI</span>不太正常等异常问题<span lang=EN-US>. </span>经过我测试<span lang=EN-US>,</span>最好是使用自己平台编译出的<span
lang=EN-US>exe</span>最好<span lang=EN-US>. </span>当然<span lang=EN-US>,</span>如果你使用系统<span
lang=EN-US>exe</span>或者其它<span lang=EN-US>EXE</span>，只要测试没问题，也是<span
lang=EN-US>OK</span>的<span lang=EN-US>. </span>另外<span lang=EN-US>,</span>这<span
lang=EN-US>2</span>个<span lang=EN-US>EXE</span>必须都是<span lang=EN-US>32</span>位的<span
lang=EN-US>,</span>否则会加载失败<span lang=EN-US>!<span
style='mso-spacerun:yes'>&nbsp;&nbsp; </span></span>调用此盾的程序相当于是个<span
lang=EN-US>EXE</span>加载器<span lang=EN-US>,</span>加载成功后<span lang=EN-US>,</span>自己就可以退出了<span
lang=EN-US>.<br>
f2</span>盾使用至少需要<span lang=EN-US>3</span>个<span lang=EN-US>EXE, A B C,</span>其中<span
lang=EN-US>A</span>是加载器，里面执行<span lang=EN-US>f2</span>盾<span lang=EN-US>,B</span>是被伪装成的程序，<span
lang=EN-US>C</span>是你的真正的程序<span lang=EN-US>. A</span>执行<span lang=EN-US>f2</span>盾类似这样<span
lang=EN-US>,DmGuard 1,&quot;f2 B C&quot;<br>
f2</span>盾有个限制，如果<span lang=EN-US>C</span>是使用<span lang=EN-US>f2</span>启动的，那么<span
lang=EN-US>C</span>里面会无法加载驱动。比如我的<span lang=EN-US>DmGuard</span>函数在<span
lang=EN-US>C</span>中会失败<span lang=EN-US>. </span>解决办法是所有在<span lang=EN-US>C</span>中需要加载的盾，都必须在<span
lang=EN-US>A</span>里面也加载一次。<span lang=EN-US> <br>
<br>
<br>
</span>另外<span lang=EN-US>5</span>个<span lang=EN-US>memory</span>盾是可以切换的<span
lang=EN-US>,</span>切换方式是重新调用另一个<span lang=EN-US>memory</span>盾即可<span
lang=EN-US>,</span>只有最后调用的<span lang=EN-US>memory</span>盾生效<span lang=EN-US>.</span></span></p>

<p><span style='font-size:13.5pt;color:fuchsia'>盾都要求在目标进程开启之前开启<span
lang=EN-US>,</span>但<span lang=EN-US>memory3</span>比较特殊<span lang=EN-US>,</span>因为他必须接一个真实存在的<span
lang=EN-US>pid</span>。 对于这种情况，只需要提前加载<span lang=EN-US>memory2,</span>等目标进程打开以后，再调用<span
lang=EN-US>memory3</span>即可<span lang=EN-US>.<br style='mso-special-character:
line-break'>
<br style='mso-special-character:line-break'>
</span></span></p>

<p><span lang=EN-US style='font-size:13.5pt;color:fuchsia'>6</span><span
style='font-size:13.5pt;color:fuchsia'>个<span lang=EN-US>memory</span>盾在相同接口下的速度如下<span
lang=EN-US> memory3&gt;memory4&gt;memory&gt;memory5=memory6&gt;memory2<br>
6</span>个<span lang=EN-US>memory</span>盾突破防护的能力如下<span lang=EN-US>
memory5=memory6&gt;memory2&gt;memory3&gt;memory4&gt;memory<br>
</span>另外<span lang=EN-US>,</span>如果您需要极限读写速度<span lang=EN-US>,</span>请使用带<span
lang=EN-US>Addr</span>系列的读写接口<span lang=EN-US>,</span>比相同系列不带<span lang=EN-US>Addr</span>的接口速度要快<span
lang=EN-US>30%. </span>如果还要加快<span lang=EN-US>,</span>那必须要定制非<span lang=EN-US>COM</span>版本的<span
lang=EN-US>DLL. COM</span>版本天生速度就慢一些<span lang=EN-US>. <br>
</span>并且使用<span lang=EN-US>SetMemoryHwndAsProcessId</span>接口<span lang=EN-US>,</span>直接使用<span
lang=EN-US>pid</span>来进行内存接口的访问<span lang=EN-US>.<br>
</span>如果您要使用<span lang=EN-US>memory</span>系列盾<span lang=EN-US>,</span>请让它第一个被加载<span
lang=EN-US>,</span>这样可以让效率最大化<span lang=EN-US>.<br style='mso-special-character:
line-break'>
<br style='mso-special-character:line-break'>
</span></span></p>

<p><span lang=EN-US style='font-size:13.5pt;color:fuchsia'>display3</span><span
style='font-size:13.5pt;color:fuchsia'>盾仅仅支持<span lang=EN-US>win7</span>以上系统<span
lang=EN-US>. </span>并且系统必须开启了<span lang=EN-US>DWM. </span>否则会返回失败<span
lang=EN-US>. win10</span>以下的系统可以手动设置<span lang=EN-US>DWM</span>的开关<span
lang=EN-US>,win10</span>以上的系统是强制打开的<span lang=EN-US>,</span>无法关闭<span
lang=EN-US>.<br>
</span>所以此盾在<span lang=EN-US>win10</span>系统上效果很好<span lang=EN-US>.<span
style='mso-spacerun:yes'>&nbsp; </span></span>下图是<span lang=EN-US>win7</span>如何打开<span
lang=EN-US>DWM,</span>也就是说只要勾选了启用桌面组合和在窗口和按钮上使用视觉样式就会开启<span lang=EN-US>dwm.
win8</span>应该也是类似<span lang=EN-US>.<br>
<br>
<span style='mso-no-proof:yes'><img border=0 width=415 height=520 src="DmGuard.files/image002.jpg" alt=1 v:shapes="图片_x0020_1"></span></span></span></p>

<p><span style='font-size:13.5pt;color:fuchsia'>如果您开启了<span lang=EN-US>dwm</span>，并且调用成功了<span
lang=EN-US>display3</span>盾后<span lang=EN-US>,</span>如果中途关闭了<span lang=EN-US>dwm,</span>那么保护就会失效<span
lang=EN-US>. </span>另外此盾只能保护当前进程的窗口<span lang=EN-US>.</span></span></p>

</div>

</body>

</html>
